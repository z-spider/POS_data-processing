POS后台数据处理脚本

###功能###
将易收银、星收宝和合利宝的后台数据，整理输出为可直接粘贴到每日报表中的格式

###更新说明###
修复了对星收宝ID映射不识别的错误

###使用说明###
概览：
把网页复制的表格分别粘贴到data目录下的“易收银日激活txt”和“易收银日交易.txt”中，双击A易收银数据处理，出现的新文件就是结果文件。
把星收宝导出的表格放入data目录下，双击B星收宝数据处理，出现的文件就是结果文件
把合利宝导出的表格放入data目录下，双击B星收宝数据处理，出现的文件就是结果文件

详细步骤：①核查ID映射-->②格式转换-->③放入新数据-->⑤④执行数据处理-->⑥⑦备份和清理

①核查“ID映射表.xlsx”有无错误
②(可选)若修改了“ID映射表.xlsx”则双击“A数据格式化.bat”,会生成新的必备文件，该文件存放在trans文件夹中
③把易收银和星收宝的数据放入data文件夹内。
（把网页复制的表格分别粘贴到data目录下的“易收银日激活txt”和“易收银日交易.txt”中。星收宝导出的表格直接放入data目录下）
④双击“B易收银数据处理.bat”，结果文件输出在当前目录下，以时间命名，可复制到excel中做进一步操作
⑤双击“B星收宝数据处理.bat”，结果文件输出在当前目录下，以时间命名，可复制到excel中做进一步操作
⑥(可选)当文件夹内结果过多时，双击“C结果备份和清理.bat”,将结果文件移入OldResult文件夹中
⑦(几乎不用)双击“C数据备份和清理”清理和备份旧的数据文件(data文件夹)，方便日后核查。
注意：为方便起见，现在执行自动的清理步骤。如果data文件夹下有多份星收宝的数据，则会输出多个结果文件。

*文件说明*
“A”开头的脚本是格式化脚本，是B脚本运行的前提
“B”开头的脚本是数据处理脚本，依赖A生成的格式化数据
“C”开头的脚本是备份和清理脚本，保证数据的可追溯性和使用环境的整洁
“YSY.txt”和“XSB.txt”由“ID映射维护.xlsx”自动生成，无需理会。
“ID映射表.xlsx”是xlsx格式的ID映射文件，可以使用excel编辑修改ID映射，“YSY”sheet是易收银的ID映射文件，“XSB”sheet是星收宝的映射文件，“HLB”sheet是合利宝的ID映射文件。
!!!注意，文件中没有映射的id是不会有数据的!!!
!!!注意，示例数据中的映射表需要重命名为“ID映射表”才能使用。
“易收银日激活.txt”是易收银后台包含日激活数据的表格，放在data文件夹中
“易收银日交易.txt”是易收银后台包含日交易数据的表格，放在data文件夹中
“Export*Trade*”是星收宝后台导出的数据文件，放在data文件夹，其格式化后的文件放在trans文件夹
“合利宝pos*”是合利宝后台导出的数据文件，放在data文件夹，其格式化后的文件放在trans文件夹
“processing.log”为perl脚本执行的日志文件，
“run.log”为bat文件执行的日志文件

###下一步###
将易收银数据处理脚本也进行模块化

###历史更新###
v0.01
	功能大致上线
v0.02
	修复了直营统计的错误
	更新了ID映射文件
	完善使用说明
	ID映射维护.xlsx中加入条件格式，映射出现重复则标红
	#加入excel直接生成“mapID.txt”文件功能
	#隐藏中间文件（用完删除）
v0.03
	修复了浮点数精度问题，现在统一保留两位小数
	修复了wps复制后为utf8-BOM编码的问题
	加入excel直接生成“mapID.txt”文件功能
	完善使用说明
v0.04-fix
	拆分功能为处理表格生成mapID和处理数据
	注：不可用
v0.03-fix
	修复了浮点数精度问题，现在日激活显示为整数
	修复0.03因打包而不可用的问题
v0.09
	不再提供打包程序
	加入对星收宝文件的支持
	拆分和细化了功能，加入清理程序
	支持了批量xlsx格式文件转换为txt
	增加日志功能，方便查询
	星收宝文件支持同时处理多份，生成多个结果文件
v0.10
	支持了多个ID映射，请用英文分号“;”分隔
	修复了多份星收宝文件存在时的bug
	现在执行任何处理文件后，会自动备份和清理相应的数据。
	即：（星收宝数据剪切至OldDate，trans文件夹临时文件删除，易收银数据拷贝至OldData，trans文件夹不动。）
v0.11
	临时修复了.bat文件不能在别的电脑使用的bug
v0.12
	删除了遗留的测试语句，这将在日志中导致空行
	增加了更详细的日志说明
v0.13
	修复了星收宝文件格式不同的问题，现在支持最新的格式
v0.14
	修复了C类清理用Bat文件的缩写bug
v0.16
	支持了合利宝日激活和日交易数据
	支持了星收宝日激活数据
	模块化了数据处理过程，可进一步扩展
v0.17
	修复了缺失激活数据后脚本不能正确运行的bug
v0.17.1
	如果文件夹不存在，可以自动创建OldData和OldResult文件夹
v0.17.2
	修复“ CRLF”错误
v0.18.1
	增加了ID映射表中含有空行空列的容错
v0.18.2
	修复了对星收宝ID映射不识别的错误
v0.18.3
	修复了合利宝模式匹配中小数点识别的错误
v0.18.4
	更新了合利宝的匹配模式以符合最新的格式
	修复合利宝结果文件名日期显示错误的bug